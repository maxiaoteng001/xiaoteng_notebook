"use strict";(self.webpackChunkxiaoteng=self.webpackChunkxiaoteng||[]).push([[3467],{3373:(n,s,a)=>{a.r(s),a.d(s,{data:()=>t});const t={key:"v-68320be0",path:"/python/python_web/django/templates.html",title:"Templates 模板",lang:"en-US",frontmatter:{},excerpt:"",headers:[{level:2,title:"1. 使用django模板",slug:"_1-使用django模板",children:[]}],filePathRelative:"python/python_web/django/templates.md",git:{updatedTime:1631876121e3,contributors:[{name:"maxiaoteng",email:"jizhuwo00@hotmail.com",commits:1}]}}},3044:(n,s,a)=>{a.r(s),a.d(s,{default:()=>i});var t=a(6252);const e=(0,t._)("h1",{id:"templates-模板",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#templates-模板","aria-hidden":"true"},"#"),(0,t.Uk)(" Templates 模板")],-1),p=(0,t._)("h2",{id:"_1-使用django模板",tabindex:"-1"},[(0,t._)("a",{class:"header-anchor",href:"#_1-使用django模板","aria-hidden":"true"},"#"),(0,t.Uk)(" 1. 使用django模板")],-1),o=(0,t.uE)('<li><p>位置，项目根目录下<code>/templates</code></p><ol><li>每个应用存放在单独的文件夹中</li><li>默认查找每个app的<code>/polls/templates/polls/index.html</code></li></ol></li><li><p><code>/project/settings.py</code>中生效</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>...\nTEMPLATES = [\n    {\n        ...\n        &#39;DIRS&#39;: [os.path.join(BASE_DIR, &#39;templates&#39;),],       # 修改位置\n        ...\n    },\n]\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li><li><p>使用render渲染</p><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 见views</span>\n<span class="token keyword">from</span> django<span class="token punctuation">.</span>shortcuts <span class="token keyword">import</span> render\nrender<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&#39;polls/index.html&#39;</span><span class="token punctuation">,</span> context<span class="token operator">=</span>context<span class="token punctuation">)</span>\n<span class="token comment"># loader</span>\n<span class="token keyword">from</span> django<span class="token punctuation">.</span>template <span class="token keyword">import</span> loader\nlatest_question_list <span class="token operator">=</span> Question<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">&#39;-pub_date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>\ntemplate <span class="token operator">=</span> loader<span class="token punctuation">.</span>get_template<span class="token punctuation">(</span><span class="token string">&#39;polls/index.html&#39;</span><span class="token punctuation">)</span>\ncontext <span class="token operator">=</span> <span class="token punctuation">{</span>\n    <span class="token string">&#39;latest_question_list&#39;</span><span class="token punctuation">:</span> latest_question_list<span class="token punctuation">,</span>\n<span class="token punctuation">}</span>\n<span class="token keyword">return</span> HttpResponse<span class="token punctuation">(</span>template<span class="token punctuation">.</span>render<span class="token punctuation">(</span>context<span class="token punctuation">,</span> request<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="token comment"># 404</span>\n<span class="token keyword">try</span><span class="token punctuation">:</span>\n    question <span class="token operator">=</span> Question<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>get<span class="token punctuation">(</span>pk<span class="token operator">=</span>question_id<span class="token punctuation">)</span>\n<span class="token keyword">except</span> Question<span class="token punctuation">.</span>DoesNotExist<span class="token punctuation">:</span>\n    <span class="token keyword">raise</span> Http404<span class="token punctuation">(</span><span class="token string">&quot;Question does not exist&quot;</span><span class="token punctuation">)</span>\n<span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&#39;polls/detail.html&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&#39;question&#39;</span><span class="token punctuation">:</span> question<span class="token punctuation">}</span><span class="token punctuation">)</span>\n<span class="token comment"># get-object-or-404</span>\nquestion <span class="token operator">=</span> get_object_or_404<span class="token punctuation">(</span>Question<span class="token punctuation">,</span> pk<span class="token operator">=</span>question_id<span class="token punctuation">)</span>\n<span class="token keyword">return</span> render<span class="token punctuation">(</span>request<span class="token punctuation">,</span> <span class="token string">&#39;polls/detail.html&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">&#39;question&#39;</span><span class="token punctuation">:</span> question<span class="token punctuation">}</span><span class="token punctuation">)</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li>',3),l=(0,t.Uk)("静态文件"),c=(0,t.Uk)("static_files.md"),u=(0,t.uE)('<li><p>django 命名空间</p><ol><li>templace中的url避免硬编码<div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;/polls/{{ question.id }}/&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> question<span class="token punctuation">.</span>question_text <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>\n<span class="token comment"># 等价</span>\n<span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">&quot;{% url &#39;detail&#39; question.id %}&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> question<span class="token punctuation">.</span>question_text <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span>\n<span class="token comment"># urls中的内容, name=&#39;detail&#39; 关联detail</span>\n<span class="token triple-quoted-string string">&#39;&#39;&#39;\npath(&#39;&lt;int:question_id&gt;/&#39;, views.detail, name=&#39;detail&#39;),\n&#39;&#39;&#39;</span>\n<span class="token comment"># 如果需要修改views.detail这个视图的url, 不需要批量修改templates中的内容, 只需要修改path即可</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li><li>一个项目可能有多个app, 也许每个app都会有detail path, 那么views如何区分不同的url <code>python # polls/urls.py app_name = &#39;polls&#39; # template &#39;&#39;&#39; &lt;a href=&quot;{% url &#39;polls.detail&#39; question.id %}&quot;&gt;&lt;a/&gt; &#39;&#39;&#39; </code></li></ol></li><li><p>Use generic views</p><ol><li>抽象listView和detailView</li></ol><div class="language-python ext-py line-numbers-mode"><pre class="language-python"><code><span class="token keyword">from</span> django<span class="token punctuation">.</span>views <span class="token keyword">import</span> generic\n<span class="token comment"># template_name 默认 &lt;app name&gt;/&lt;model name&gt;_list.html</span>\n<span class="token comment"># context_object_name 默认 &lt;model name&gt;_list</span>\n<span class="token keyword">class</span> <span class="token class-name">IndexView</span><span class="token punctuation">(</span>generic<span class="token punctuation">.</span>ListView<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    template_name <span class="token operator">=</span> <span class="token string">&#39;polls/index.html&#39;</span>\n    context_object_name <span class="token operator">=</span> <span class="token string">&#39;latest_question_list&#39;</span>\n    <span class="token keyword">def</span> <span class="token function">get_queryset</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>\n        <span class="token triple-quoted-string string">&quot;&quot;&quot;Return the last five published questions.&quot;&quot;&quot;</span>\n        <span class="token keyword">return</span> Question<span class="token punctuation">.</span>objects<span class="token punctuation">.</span>order_by<span class="token punctuation">(</span><span class="token string">&#39;-pub_date&#39;</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span>\n<span class="token comment"># template_name 默认 &lt;app name&gt;/&lt;model name&gt;_detail.html</span>\n<span class="token comment"># context_object_name 默认 &lt;model name&gt;</span>\n<span class="token keyword">class</span> <span class="token class-name">DetailView</span><span class="token punctuation">(</span>generic<span class="token punctuation">.</span>DetailView<span class="token punctuation">)</span><span class="token punctuation">:</span>\n    model <span class="token operator">=</span> Question\n    template_name <span class="token operator">=</span> <span class="token string">&#39;polls/detail.html&#39;</span>\n</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li>',2),i={render:function(n,s){const a=(0,t.up)("RouterLink");return(0,t.wg)(),(0,t.iD)(t.HY,null,[e,p,(0,t._)("ol",null,[o,(0,t._)("li",null,[(0,t._)("p",null,[l,(0,t.Wm)(a,{to:"/python/python_web/django/static_files.html"},{default:(0,t.w5)((()=>[c])),_:1})])]),u])],64)}}}}]);